# Обзор безопасности текущей архитектуры

В этом документе описаны плюсы, минусы и потенциальные улучшения безопасности для текущей системы аутентификации, основанной на локальном хранилище (`localStorage`) с применением криптографического шифрования на стороне клиента.

## Текущая архитектура

- **Аутентификация:** Полностью на стороне клиента, управляется через React Context (`src/context/auth-context.tsx`).
- **Хранение данных пользователей:** Данные профиля каждого пользователя хранятся в `localStorage` браузера в **зашифрованном** виде.
- **Защита паролей:** Пароли не хранятся напрямую. Вместо этого они используются для генерации ключа шифрования с помощью криптографически стойкого алгоритма **PBKDF2** с 300 000 итераций и уникальной "солью" для каждого пользователя.
- **Шифрование данных:** Данные профиля шифруются с помощью алгоритма **AES-GCM**, а ключ для расшифровки доступен только во время активной сессии пользователя (в `sessionStorage`) и уничтожается при закрытии вкладки.

---

## Плюсы (Преимущества)

1.  **Полная автономность:** Приложение может работать полностью офлайн после первоначальной загрузки. Нет зависимости от доступности сети или внешних сервисов.
2.  **Нулевые затраты:** Отсутствует необходимость в серверной инфраструктуре (backend) и базах данных, что исключает расходы на хостинг.
3.  **Высокая скорость работы:** Все операции (вход, регистрация, доступ к данным) выполняются мгновенно, так как не требуют сетевых запросов.
4.  **Значительно повышенная безопасность (для локального решения):**
    - **Защита от прямого доступа:** Если злоумышленник получит доступ к `localStorage`, он увидит лишь зашифрованный набор символов, бесполезный без пароля пользователя.
    - **Сопротивление брутфорсу (перебору паролей):** Использование PBKDF2 с большим количеством итераций делает подбор пароля крайне медленным и вычислительно дорогим.
    - **Защита от радужных таблиц:** Уникальная "соль" для каждого пользователя делает невозможным применение заранее вычисленных хэшей.
5.  **Конфиденциальность:** Данные пользователя не покидают его браузер и не передаются на какой-либо сервер.

---

## Минусы (Недостатки)

Несмотря на серьезные улучшения, некоторые фундаментальные ограничения локального хранения остаются:

1.  **Уязвимость к продвинутым XSS-атакам (Cross-Site Scripting):** Если в приложении появится уязвимость, позволяющая выполнить сторонний JavaScript-код **во время активной сессии пользователя**, злоумышленник теоретически может получить доступ к ключу расшифровки из `sessionStorage` и украсть данные. Это значительно сложнее, чем раньше, но возможно.

2.  **Отсутствие синхронизации между устройствами:** Пользователь, зарегистрировавшийся в одном браузере, не сможет войти в свой аккаунт на другом устройстве. Данные привязаны к конкретному браузеру.

3.  **Высокий риск потери данных:** Если пользователь очистит данные своего браузера (`localStorage`, `sessionStorage`), все созданные аккаунты будут **безвозвратно удалены**. Нет механизма восстановления.

4.  **Немасштабируемость:** Система не подходит для реального многопользовательского приложения с централизованным управлением.

---

## Варианты дальнейшего улучшения

Защитить текущую локальную систему еще сильнее практически невозможно, оставаясь в рамках клиентской части. Следующий логический шаг — переход на серверную архитектуру.

### Настоятельно рекомендуемый путь (для публичных приложений)

**Единственный способ обеспечить максимальную безопасность и функциональность — это использовать серверную систему аутентификации.**

Рекомендуемое решение — **Firebase Authentication**.

**Преимущества Firebase Authentication:**

- **Профессиональная безопасность:** Разработано Google. Все данные и ключи надежно хранятся на серверах, а не в браузере.
- **Централизация и синхронизация:** Пользователи могут входить в свой аккаунт с любого устройства.
- **Надежность:** Данные не теряются при очистке кэша браузера.
- **Дополнительные провайдеры:** Легко настраивается вход через Google, GitHub, Facebook и другие сервисы.
- **Масштабируемость:** Готовое решение для приложений с любым количеством пользователей.

## Вывод

Текущая локальная система с шифрованием является **отличным и достаточно безопасным решением для прототипа, личного проекта или офлайн-инструмента**. Она обеспечивает надежную защиту данных от большинства распространенных атак.

Однако для любого приложения, которое будет доступно публично, обрабатывать чувствительные данные и требовать синхронизации между устройствами, **категорически рекомендуется перейти на серверное решение, такое как Firebase Authentication.**
